<%@ Page Title="" Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="Login.aspx.cs" Inherits="Login" %> <%@ Register Assembly="MSCaptcha" Namespace="MSCaptcha" TagPrefix="cc1" %> <asp:Content ID="Content1" ContentPlaceHolderID="head" runat="Server"> <style type="text/css"> .txtEmailESenha{min-width:105px;} .btnEvento {min-height:32px;max-width:150px;border-style: none;border-color: inherit;border-width: medium;font-size: 16px;background-color: #00ffff;color: white;padding: 6px;cursor: pointer;border-radius: 4px;transition: 0.3s;} .btnEvento:hover {background-color: #58d7ee;transition: 0.3s;} ul.tab {list-style-type: none;margin: 0;padding: 0;overflow: hidden;border: 1px solid #00ffff;background-color: #ffffff;} ul.tab li {float: left;} ul.tab li a {display: inline-block;background-color: #fff;color: #00ffff;text-align: center;padding: 12px 14px;text-decoration: none;transition: 0.3s;font-size: 16px;} ul.tab li a:hover {background-color: #eee;} ul.tab li a:focus, .active {background-color: #00ffff;color:white;} .tabContent {display: none;padding: 4px 10px;} .auto-style1 {width: 25%;} .auto-style2 {width: 42%;} .auto-style3 {width: 20%;height: 46px;} .auto-style4 {width: 20%;height: 46px;} .auto-style5 {height: 46px;} .auto-style6 {width: 30%;height: 30%;} .auto-style7 {width: 40%;height: 36px;} .auto-style8 {height: 36px;} .auto-style9 {width: 25%;height: 41px;} .auto-style10 {width: 40%;height: 40%;} .auto-style11 {height: 30%;} .auto-style13 {width: 10%;} .auto-style14 {color: #CC0000;} .auto-style15 {width: 50%;} .auto-style16 {width: 50%;} .auto-style17 {width: 20%;height: 40%;} .auto-style18 {width: 40%;height: 20%;} .auto-style19 {height: 20%;} </style> </asp:Content> <asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server"> <form id="form1" runat="server"> <ul class="tab"> <li><a href="javascript:void(0)" class="tabLinks" onclick="openTab(event, 'LoginNormal')" id="defaultOpen">LOGIN PELO EMAIL</a></li> <li><a href="javascript:void(0)" class="tabLinks" onclick="openTab(event, 'QRCode')" id="qrCode">QR CODE</a></li> </ul> <div id="LoginNormal" class="tabContent"> <table style="width: 100%; height: 175px; margin-left: 0px;"> <tr> <td style="text-align: center; font-weight: bold; font-size: 20px; padding: 10px;" class="auto-style17">LOGIN <div class="line-title bg-primary"></div> </td> <td class="auto-style18"></td> <td class="auto-style19"></td> </tr> <tr> <td class="auto-style3" style="text-align: right; font-size: 16px">Email: </td> <td class="auto-style4">&nbsp;&nbsp;<asp:TextBox ID="txtEmail" runat="server" Width="40%" CssClass="txtEmailESenha"></asp:TextBox> </td> <td class="auto-style5"></td> </tr> <tr> <td class="auto-style6" style="text-align: right; font-size: 16px">Senha:</td> <td class="auto-style7">&nbsp;&nbsp;<asp:TextBox ID="txtSenha" runat="server" Width="40%" TextMode="Password" CssClass="txtEmailESenha"></asp:TextBox> &nbsp;&nbsp;&nbsp;<a href="esqSenha.aspx" style="text-decoration:none; color:cyan; font-weight:bold;">Esqueceu sua senha?</a> </td> <td class="auto-style8"></td> </tr> <tr> <td class="auto-style6" style="text-align: right; font-size: 16px">&nbsp;</td> <td class="auto-style7"> <table class="auto-style16"> <tr> <td class="auto-style15"> <asp:Label ID="lblDigTxt" runat="server" Text="Digite o texto:" Visible="False"></asp:Label> <br /> <asp:TextBox ID="txtCaptcha" runat="server" Visible="False"></asp:TextBox> </td> <td class="auto-style13">&nbsp;</td> </tr> <tr> <td class="auto-style15"> <cc1:CaptchaControl ID="Captcha" runat="server" CaptchaBackgroundNoise="Low" CaptchaHeight="60" CaptchaLength="5" CaptchaMaxTimeout="240" CaptchaMinTimeout="5" CaptchaWidth="200" FontColor="#D20B0C" NoiseColor="#B1B1B1" Visible="False" Width="100%" /> </td> <td class="auto-style13"> <asp:ImageButton ID="imgCaptcha" runat="server" CausesValidation="false" ImageUrl="~/img/refresh.png" Visible="False" Height="70%" ImageAlign="Middle" Width="40px" /> </td> </tr> <tr> <td class="auto-style15"><strong> <asp:Label ID="lblCapVal" runat="server" Text="CAPTCHA VÁLIDO!" ForeColor="Cyan" Visible="False"></asp:Label> <br /> <asp:CustomValidator ID="cvValido" runat="server" CssClass="auto-style14" ErrorMessage="INVÁLIDO!" OnServerValidate="ValidateCaptcha" Visible="False" ForeColor="Red" /> </strong></td> <td class="auto-style13">&nbsp;</td> </tr> </table> </td> <td class="auto-style8">&nbsp;</td> </tr> <tr> <td class="auto-style1" style="text-align: right; font-size: 16px">Tipo de Usuário:</td> <td class="auto-style2"> <asp:RadioButtonList ID="rblTipoUsu" runat="server" Width="100%" OnSelectedIndexChanged="rblTipoUsu_SelectedIndexChanged"> <asp:ListItem>Cliente Físico</asp:ListItem> <asp:ListItem>Empresa</asp:ListItem> </asp:RadioButtonList> </td> <td>&nbsp;</td> </tr> <tr> <td class="auto-style9" style="text-align: right; font-size: 16px"></td> <td class="auto-style10"> <asp:Label ID="lblErro" runat="server" Font-Bold="True" ForeColor="Red"></asp:Label> </td> <td class="auto-style11">Possui Empresa? <a href="CadastroEmp.aspx" style="color: cyan; font-weight: bold;">Anuncie</a>. </td> </tr> <tr> <td class="auto-style1" style="text-align: right; font-size: 16px"> <asp:SqlDataSource ID="sqlLogin" runat="server" ConnectionString="<%$ ConnectionStrings:neonaeConnectionString %>" ProviderName="<%$ ConnectionStrings:neonaeConnectionString.ProviderName %>" SelectCommand="SELECT email, senha, tipo_usuario FROM login WHERE (email = @email) AND (senha = @senha) AND (tipo_usuario = @tipo)" InsertCommand="insert into aud_usu values(0,@id,@table,@desc,@hr,@data)" UpdateCommand="update usuario set ativo_usu=1 where id_usu=@id"> <InsertParameters> <asp:Parameter Name="id" /> <asp:Parameter Name="table" /> <asp:Parameter Name="desc" /> <asp:Parameter Name="hr" /> <asp:Parameter Name="data" /> </InsertParameters> <SelectParameters> <asp:Parameter Name="email" /> <asp:Parameter Name="senha" /> <asp:Parameter Name="tipo" /> </SelectParameters> <UpdateParameters> <asp:Parameter Name="id" /> </UpdateParameters> </asp:SqlDataSource> <asp:SqlDataSource ID="sqlLoginEmpresa" runat="server" ConnectionString="<%$ ConnectionStrings:neonaeConnectionString %>" ProviderName="<%$ ConnectionStrings:neonaeConnectionString.ProviderName %>" SelectCommand="SELECT email, senha FROM loginemp WHERE (email = @email) AND (senha = @senha)" InsertCommand="insert into aud_emp values(0,@id,@table,@desc,@hr,@data)" UpdateCommand="update cliente_emp set ativo_emp=1 where id_emp=@id"> <InsertParameters> <asp:Parameter Name="id" /> <asp:Parameter Name="table" /> <asp:Parameter Name="desc" /> <asp:Parameter Name="hr" /> <asp:Parameter Name="data" /> </InsertParameters> <SelectParameters> <asp:Parameter Name="email" /> <asp:Parameter Name="senha" /> </SelectParameters> <UpdateParameters> <asp:Parameter Name="id" /> </UpdateParameters> </asp:SqlDataSource> <asp:SqlDataSource ID="sqlIdEmp" runat="server" ConnectionString="<%$ ConnectionStrings:neonaeConnectionString %>" ProviderName="<%$ ConnectionStrings:neonaeConnectionString.ProviderName %>" SelectCommand="SELECT * FROM getidemp where email=@email" InsertCommand="insert into aud_adm values(0,@id,@table,@desc,@hr,@data)"> <InsertParameters> <asp:Parameter Name="id" /> <asp:Parameter Name="table" /> <asp:Parameter Name="desc" /> <asp:Parameter Name="hr" /> <asp:Parameter Name="data" /> </InsertParameters> <SelectParameters> <asp:Parameter Name="email" /> </SelectParameters> </asp:SqlDataSource> <asp:SqlDataSource ID="sqlIdUsu" runat="server" ConnectionString="<%$ ConnectionStrings:neonaeConnectionString %>" ProviderName="<%$ ConnectionStrings:neonaeConnectionString.ProviderName %>" SelectCommand="SELECT id, email FROM getidusu WHERE (email = @email)" InsertCommand="insert into aud_func values(0,@id,@table,@desc,@hr,@data)"> <InsertParameters> <asp:Parameter Name="id" /> <asp:Parameter Name="table" /> <asp:Parameter Name="desc" /> <asp:Parameter Name="hr" /> <asp:Parameter Name="data" /> </InsertParameters> <SelectParameters> <asp:Parameter Name="email" /> </SelectParameters> </asp:SqlDataSource> </td> <td class="auto-style2"> <asp:Button ID="btnLogin" runat="server" Height="125%" Text="LOGIN" Width="40%" Font-Bold="True" OnClick="btnLogin_Click" CssClass="btnEvento" /> </td> <td class="auto-style11">Não possui cadastro? <a href="CadastroUsuario.aspx" style="color: cyan; font-weight: bold;">Clique aqui</a>.</td> </tr> </table> </div> <div id="QRCode" class="tabContent" style="text-align:center;"> <asp:SqlDataSource ID="sqlLoginQR" runat="server" ConnectionString="<%$ ConnectionStrings:neonaeConnectionString %>" ProviderName="<%$ ConnectionStrings:neonaeConnectionString.ProviderName %>" SelectCommand="SELECT login_qrc, senha_qrc, dthr_qrc,ativo_qrc FROM qrcode"></asp:SqlDataSource> <asp:Image ID="imgQRCode" runat="server" ImageAlign="Middle" Height="100%" Width="25%"/> <p>Utilize o aplicativo do <a style="color:cyan; font-weight:bold;">NEON AE</a> no seu celular para<br /> ler o código.</p> </div> <script> function openTab(evt, tabName) { var i, tabcontent, tablinks; tabcontent = document.getElementsByClassName("tabContent"); for (i = 0; i < tabcontent.length; i++) { tabcontent[i].style.display = "none"; } tablinks = document.getElementsByClassName("tabLinks"); for (i = 0; i < tablinks.length; i++) { tablinks[i].className = tablinks[i].className.replace(" active", ""); } document.getElementById(tabName).style.display = "block"; evt.currentTarget.className += " active"; } document.getElementById("defaultOpen").click(); </script> <asp:Timer ID="Timer1" runat="server" Interval="13000" OnTick="Timer1_Tick"> </asp:Timer> <asp:ScriptManager ID="ScriptManager1" runat="server"> </asp:ScriptManager> <asp:SqlDataSource ID="sqlQRCode" runat="server" ConnectionString="<%$ ConnectionStrings:neonaeConnectionString %>" ProviderName="<%$ ConnectionStrings:neonaeConnectionString.ProviderName %>" SelectCommand="SELECT * FROM qrcode" UpdateCommand="update qrcode set ativo_qrc=0 where id_qrc=@id"> <UpdateParameters> <asp:Parameter Name="id" /> </UpdateParameters> </asp:SqlDataSource> <asp:SqlDataSource ID="sqlGetEmailnNameUsu" runat="server" ConnectionString="<%$ ConnectionStrings:neonaeConnectionString %>" ProviderName="<%$ ConnectionStrings:neonaeConnectionString.ProviderName %>" SelectCommand="SELECT nome_usu,email_usu,ativo_usu FROM usuario where email_usu=@email"> <SelectParameters> <asp:Parameter Name="email" /> </SelectParameters> </asp:SqlDataSource> <asp:SqlDataSource ID="sqlGetEmailnNameEmp" runat="server" ConnectionString="<%$ ConnectionStrings:neonaeConnectionString %>" ProviderName="<%$ ConnectionStrings:neonaeConnectionString.ProviderName %>" SelectCommand="SELECT responsavel_emp,email_emp,ativo_emp FROM cliente_emp where email_emp=@email"> <SelectParameters> <asp:Parameter Name="email" /> </SelectParameters> </asp:SqlDataSource> </form> </asp:Content> 