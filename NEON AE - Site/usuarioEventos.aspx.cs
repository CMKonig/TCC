using System;using System.Collections.Generic;using System.Linq;using System.Web;using System.Web.UI;using System.Web.UI.WebControls;using System.Data;using System.Drawing; public partial class eventosUsuario : System.Web.UI.Page { Criptografia cripto = new Criptografia("NEON"); protected void Page_Load(object sender, EventArgs e) { listarTudo(); DataTable exibeDL = listarTudo(); dlEventos.DataSource = exibeDL; dlEventos.DataBind(); try { DataView dv = (DataView)sqlEventos.Select(DataSourceSelectArguments.Empty); DataView dv2 = (DataView)sqlCompra.Select(DataSourceSelectArguments.Empty); if (dv.Table.Rows.Count == 0) { dlEventos.Enabled = false;dlEventos.Visible = false; lblResp.ForeColor = Color.Cyan; lblResp.Text = "NÃO HÁ EVENTOS AINDA!"; } else{if (dv2.Table.Rows.Count == 0) { btnMeusEventos.Visible = false; }else { btnMeusEventos.Visible = true; }} } catch { Email.erro("usuarioEventos.aspx"); lblResp.ForeColor=Color.Red;lblResp.Text="ERRO! TENTE NOVAMENTE MAIS TARDE"; } Contador.click = 0; Contador.click2 = 0; } public DataTable listarTudo() { DataView dv = (DataView)sqlEventos.Select(DataSourceSelectArguments.Empty); DataTable nTab = new DataTable(); nTab.Columns.Add("id",typeof(int)); nTab.Columns.Add("nome_evento", typeof(string)); nTab.Columns.Add("tipo", typeof(string)); nTab.Columns.Add("subtipo", typeof(string)); nTab.Columns.Add("faet", typeof(string)); nTab.Columns.Add("empresa", typeof(string)); nTab.Columns.Add("img", typeof(string)); nTab.Columns.Add("data", typeof(DateTime)); for(int i=0; i < dv.Table.Rows.Count; i++) { DataRow line = nTab.NewRow(); line["id"] = dv.Table.Rows[i]["id"].ToString(); line["nome_evento"] = cripto.Decrypt(dv.Table.Rows[i]["nome_evento"].ToString()); line["tipo"] = cripto.Decrypt(dv.Table.Rows[i]["tipo"].ToString()); line["subtipo"] = cripto.Decrypt(dv.Table.Rows[i]["subtipo"].ToString()); line["faet"] = cripto.Decrypt(dv.Table.Rows[i]["faet"].ToString()); line["empresa"] = cripto.Decrypt(dv.Table.Rows[i]["empresa"].ToString()); line["img"] = "~//img//uploaded//"+cripto.Decrypt(dv.Table.Rows[i]["img"].ToString()); line["data"] = dv.Table.Rows[i]["data"].ToString(); nTab.Rows.Add(line); } return nTab; } protected void btnMeusEventos_Click(object sender, EventArgs e) { Response.Redirect("usuariosIngAdquiridos.aspx"); } }