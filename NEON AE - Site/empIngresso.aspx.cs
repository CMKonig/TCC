using System;using System.Collections.Generic;using System.Linq;using System.Web;using System.Web.UI;using System.Web.UI.WebControls;using System.Drawing; public partial class empIngresso : System.Web.UI.Page { Criptografia cripto = new Criptografia("NEON"); protected void Page_Load(object sender, EventArgs e){} protected void btnCriarEvento_Click(object sender, EventArgs e) { try { if (txtQtdIng.Text == string.Empty || txtPreco.Text == string.Empty || txtQtdIng.Text == string.Empty && txtPreco.Text == string.Empty) { lblResp.ForeColor = Color.Red; lblResp.Text = "PREENCHA OS CAMPOS EM VERMELHO!"; txtQtdIng.BorderColor = Color.Red; txtPreco.BorderColor = Color.Red; } else { sqlIngressos.InsertParameters["qtd"].DefaultValue = cripto.Encrypt(txtQtdIng.Text); sqlIngressos.InsertParameters["preco"].DefaultValue = cripto.Encrypt(txtPreco.Text.Replace(',', '.')); aud_emp(); sqlEventos.Insert(); sqlIngressos.Insert(); sqlRanking.InsertParameters["classif"].DefaultValue = cripto.Encrypt("BRONZE"); sqlRanking.InsertParameters["qtdfav"].DefaultValue = cripto.Encrypt("0"); sqlRanking.Insert(); sqlAudEmp.Insert(); Response.Redirect("empEventos.aspx"); } } catch(System.Data.SqlClient.SqlException) { Email.erro("empIngresso.aspx"); lblResp.ForeColor = Color.Red; lblResp.Text = "ERRO! TENTE NOVAMENTE MAIS TARDE."; } } public void aud_emp() { sqlAudEmp.InsertParameters["id"].DefaultValue = Session["idEmp"].ToString(); sqlAudEmp.InsertParameters["table"].DefaultValue = "evento"; sqlAudEmp.InsertParameters["desc"].DefaultValue = "Criando um evento"; string hr = DateTime.Now.Hour.ToString() + ":" + DateTime.Now.Minute.ToString(); sqlAudEmp.InsertParameters["hr"].DefaultValue = hr; string data = DateTime.Now.Date.ToShortDateString(); sqlAudEmp.InsertParameters["data"].DefaultValue = data; } }